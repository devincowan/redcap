(("undefined"!==typeof self?self:this)["webpackJsonpdatamart_vue"]=("undefined"!==typeof self?self:this)["webpackJsonpdatamart_vue"]||[]).push([[0],{"0342":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{class:"btn btn-sm "+t.types[t.type],attrs:{type:"button",disabled:t.disabled},on:{click:function(e){return t.$emit("click")}}},[t.icon?a("i",{class:t.icon}):t._e(),t._v(t._s(t.text))])},s=[],i=(a("dca8"),Object.freeze({primary:"btn-primary",secondary:"btn-secondary",success:"btn-success",info:"btn-info",danger:"btn-danger",warning:"btn-warning",light:"btn-light",dark:"btn-dark",transparent:""})),r={name:"SubmitButton",data:function(){return{types:i}},props:{type:{type:String,default:i.primary},icon:{type:String,default:null},text:{type:String,default:"submit"},disabled:{type:Boolean,default:!1}}},o=r,c=(a("734f"),a("2877")),l=Object(c["a"])(o,n,s,!1,null,"2c813b38",null);e["a"]=l.exports},1080:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("StyledButton",{attrs:{type:"light",text:"Import Revision",icon:"fas fa-file-import"},on:{click:t.importRevision}})},s=[],i=(a("4160"),a("a630"),a("3ca3"),a("159b"),a("96cf"),a("1da1")),r=a("0342"),o={name:"ImportRevisionButton",components:{StyledButton:r["a"]},computed:{userCanImportRevision:function(){var t=this.$store.state.user.info;if(!t)return!1;var e=t.super_user,a=t.can_create_revision;return!!e||a}},methods:{importRevision:function(){var t=this,e=document.createElement("input");e.setAttribute("type","file"),e.style.display="none",document.body.appendChild(e),e.addEventListener("change",function(){var a=Object(i["a"])(regeneratorRuntime.mark((function a(n){var s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=new FormData,Array.from(e.files).forEach((function(t){s.append("files[]",t)})),a.next=4,t.$store.dispatch("revision/import",s);case 4:i=a.sent,t.$emit("import",i),i||t.$swal.fire({type:"error",title:"import error",text:"The file you are trying to import could not be processed."}),e.remove();case 8:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()),e.click()}}},c=o,l=a("2877"),d=Object(l["a"])(c,n,s,!1,null,"b2140794",null);e["a"]=d.exports},1525:function(t,e,a){"use strict";var n=a("f1b9"),s=a.n(n);s.a},"2ffe":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.revision?a("section",{staticClass:"card detail"},[a("div",{staticClass:"card-header"},[a("header",[a("RevisionMetadata",{attrs:{revision:t.revision}}),a("RevisionImportExport",{staticClass:"revision-import-export"}),t._t("header")],2)]),a("div",{staticClass:"card-body"},[a("main",[a("section",[t._m(0),a("DateRangeInfo",{attrs:{min:t.revision.dateMin,max:t.revision.dateMax}})],1),a("section",[t._m(1),a("FieldsReadOnly",{attrs:{list:t.revision.fields}})],1),t.showMrns?a("section",{staticClass:"revisions"},[t._m(2),a("MRNList",{attrs:{list:t.revision.mrns}})],1):t._e()]),a("footer",[t._t("footer")],2)])]):t._e()},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h5",{staticClass:"card-title"},[a("i",{staticClass:"fas fa-calendar-week"}),t._v(" Range of time from which to pull data")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h5",{staticClass:"card-title"},[a("i",{staticClass:"fas fa-tasks"}),t._v(" Fields in EHR for which to pull data")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h5",{staticClass:"card-title"},[a("i",{staticClass:"fas fa-clipboard-list"}),t._v(" Medical record numbers of patients in EHR for which to create records on revision approval")])}],i=a("710e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("Dropdown",{staticClass:"import-export",attrs:{right:"",hideCaret:"",text:"",icon:"fas fa-cog"},scopedSlots:t._u([{key:"items",fn:function(){return[a("ExportRevisionButton",{staticClass:"export"}),a("ImportRevisionButton",{staticClass:"import",on:{import:t.onImport}})]},proxy:!0}])})],1)},o=[],c=a("cd0b"),l=a("1080"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("StyledButton",{attrs:{type:"light",text:"Export Revision",icon:"fas fa-file-export"},on:{click:t.showRevisionExportModal}})},u=[],f=(a("99af"),a("96cf"),a("1da1")),p=a("8bbf"),m=a.n(p),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card group columns-settings"},[a("h6",{staticClass:"card-header"},[t._v("Columns")]),a("div",{staticClass:"card-body"},[a("div",{staticClass:"line"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dates,expression:"dates"}],attrs:{type:"checkbox",name:"dates",value:"true",id:"export_dates"},domProps:{checked:Array.isArray(t.dates)?t._i(t.dates,"true")>-1:t.dates},on:{change:function(e){var a=t.dates,n=e.target,s=!!n.checked;if(Array.isArray(a)){var i="true",r=t._i(a,i);n.checked?r<0&&(t.dates=a.concat([i])):r>-1&&(t.dates=a.slice(0,r).concat(a.slice(r+1)))}else t.dates=s}}}),t._m(0)]),a("div",{staticClass:"line"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.fields,expression:"fields"}],attrs:{type:"checkbox",name:"fields",value:"true",id:"export_fields"},domProps:{checked:Array.isArray(t.fields)?t._i(t.fields,"true")>-1:t.fields},on:{change:function(e){var a=t.fields,n=e.target,s=!!n.checked;if(Array.isArray(a)){var i="true",r=t._i(a,i);n.checked?r<0&&(t.fields=a.concat([i])):r>-1&&(t.fields=a.slice(0,r).concat(a.slice(r+1)))}else t.fields=s}}}),t._m(1)])])]),a("div",{staticClass:"card group format-settings"},[a("h6",{staticClass:"card-header"},[t._v("Format:")]),a("div",{staticClass:"card-body"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.selected_format,expression:"selected_format"}],attrs:{name:"format",id:"export_format"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected_format=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:""}},[t._v("choose a format")]),t._l(t.formats,(function(e,n){return a("option",{key:n,domProps:{value:e,textContent:t._s(e)}})}))],2),"csv"===t.selected_format?a("select",{directives:[{name:"model",rawName:"v-model",value:t.csv_delimiter,expression:"csv_delimiter"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.csv_delimiter=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:","}},[t._v(", (comma)")]),a("option",{attrs:{value:"tab"}},[t._v("\\t (tab)")]),a("option",{attrs:{value:";"}},[t._v("; (semi-colon)")]),a("option",{attrs:{value:"|"}},[t._v("| (pipe)")]),a("option",{attrs:{value:"^"}},[t._v("^ (caret)")])]):t._e()])])])},_=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"export_dates"}},[a("i",{staticClass:"fas fa-calendar-week"}),t._v(" Date range")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"export_fields"}},[a("i",{staticClass:"fas fa-tasks"}),t._v(" Fields")])}],h={name:"RevisionExportSettings",data:function(){return{fields:!1,dates:!1,formats:["csv","json"],selected_format:"csv",csv_delimiter:","}},props:{revision:{type:Object,default:function(){return{}}}},computed:{settings:function(){var t=function(t){var e=t.fields,a=t.dates,n=t.selected_format;return{fields:e,dates:a,format:n}}(this.$data);return"csv"===t.format&&(t.csv_delimiter=this.csv_delimiter,"tab"==t.csv_delimiter&&(t.csv_delimiter="\t")),t}},watch:{settings:function(){this.$emit("update",this.settings)}},methods:{validate:function(){return!0===(this.fields||this.dates)}}},b=h,y=(a("9d08"),a("2877")),x=Object(y["a"])(b,v,_,!1,null,"25182302",null),g=x.exports,C=a("0342"),w=function(t){var e=t.mrns,a=t.fields,n=t.dates,s=[];return e&&s.push("mrns"),a&&s.push("fields"),n&&s.push("dateMin","dateMax"),s},R={name:"ExportRevisionButton",components:{StyledButton:C["a"]},computed:{revision:function(){return this.$store.getters["revisions/selected"]}},methods:{showRevisionExportModal:function(){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function e(){var a,n,s,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.$swal.fire({title:"Select your export settings",allowOutsideClick:!0,allowEscapeKey:!0,showConfirmButton:!0}),n=t.$swal.getConfirmButton(),n.disabled=!0,s={revision:t.revision},t.$swal.addVueComponent(g,{propsData:s}),i=t.$swal.getComponent(),i.$on("update",(function(t){n.disabled=!i.validate()})),e.next=9,a;case 9:r=e.sent,!0===r.value&&(o=i.settings,t.exportRevision(o));case 11:case"end":return e.stop()}}),e)})))()},exportRevision:function(t){var e=t.format,a=t.csv_delimiter,n=void 0===a?",":a,s=this.revision.getID(),i=w(t),r=m.a.$API.getExportURL({revision_id:s,fields:i,format:e,csv_delimiter:n}),o=document.createElement("a"),c="datamart_revision_".concat(s,".").concat(e);o.setAttribute("download",c),o.setAttribute("target","_SELF"),o.setAttribute("href",r),o.innerText="download",document.body.appendChild(o),o.click(),o.remove()}}},k=R,D=Object(y["a"])(k,d,u,!1,null,"99542012",null),E=D.exports,$={name:"RevisionImportExport",components:{Dropdown:c["a"],ImportRevisionButton:l["a"],ExportRevisionButton:E},methods:{onImport:function(t){t&&this.$router.push({name:"create-revision"})}}},M=$,O=(a("dabe"),Object(y["a"])(M,r,o,!1,null,"5715cc97",null)),j=O.exports,I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",[a("section",{staticClass:"title"},[a("span",{staticClass:"revision-title"},[t._v("Revision")]),a("span",[t._v(" created by "),a("span",[a("a",{attrs:{href:"mailto:"+t.user.user_email}},[t._v(t._s(t.user.user_firstname+" "+t.user.user_lastname))])])]),a("span",{staticClass:"revision-creation-date info",attrs:{title:t.date(t.revision.metadata.date)}},[t._v(" "+t._s(t.created_at_readable))])]),a("section",{staticClass:"details"},[a("RevisionMetadataIcons",{attrs:{revision:t.revision}}),t.revision.metadata.executed_at?a("span",{staticClass:"last-execution"},[t._v("| Last execution time: "),a("span",{staticClass:"info",attrs:{title:t.date(t.revision.metadata.executed_at)}},[t._v(t._s(t.executed_at_readable))])]):a("span",{staticClass:"last-execution"},[t._v("| never executed")])],1)])},S=[],F=a("5136"),B=1e3,A=!1,N={name:"RevisionMetadata",data:function(){return{created_at_readable:"",executed_at_readable:""}},components:{RevisionMetadataIcons:F["a"]},props:{revision:{type:Object,default:null}},created:function(){var t=this;this.setHumanReadableDates(),A=setInterval((function(){t.setHumanReadableDates()}),B)},beforeDestroy:function(){clearInterval(A)},computed:{user:function(){return this.revision.metadata.creator}},watch:{revision:function(){this.setHumanReadableDates()}},methods:{setHumanReadableDates:function(){var t=this.revision;this.created_at_readable=Object(i["e"])(t.metadata.date),this.executed_at_readable=Object(i["e"])(t.metadata.executed_at)},date:function(t){return Object(i["b"])(t,"MM-DD-YYYY hh:mm:ss")}}},Y=N,L=(a("a28f"),Object(y["a"])(Y,I,S,!1,null,"0f9d4450",null)),H=L.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",[a("section",{staticClass:"date-range"},[t.dateMin?a("span",{staticClass:"date-wrapper"},[a("span",{staticClass:"label"},[t._v("From")]),a("span",{staticClass:"date"},[t._v(t._s(t.dateMin))])]):t._e(),t.dateMax?a("span",{staticClass:"date-wrapper"},[a("span",{staticClass:"label"},[t._v(" to")]),a("span",{staticClass:"date"},[t._v(t._s(t.dateMax))])]):t._e(),t.dateMin||t.dateMax?t._e():a("span",[t._v("no date range specified (get all available data)")])])])},T=[],J=(a("498a"),a("c1df")),z=a.n(J),K="MM-DD-YYYY",U={name:"DateRangeInfo",props:{min:{type:String,default:""},max:{type:String,default:""}},computed:{dateMin:function(){return this.getFormattedDate(this.min)},dateMax:function(){return this.getFormattedDate(this.max)}},methods:{getFormattedDate:function(t){return""==t.trim()?t:z()(t).format(K)}}},V=U,q=(a("d206"),Object(y["a"])(V,P,T,!1,null,"66a0bf6a",null)),G=q.exports,Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[t._m(0),a("main",[t.sourceFields?a("section",{staticClass:"FieldsReadOnly"},t._l(t.sourceFields,(function(t,e){return a("FieldNode",{key:e,attrs:{node:t}})})),1):t._e()])])},W=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",[a("span",[t._v("Source Fields List")])])}],X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"node"},[0===t.node.data.length?[a("label",{attrs:{for:t.node.name,title:t.node.attributes.description}},[t._v(t._s(t.node.attributes.field)+" ("+t._s(t.node.attributes.label)+")")])]:[a("Details",{staticClass:"node-list",scopedSlots:t._u([{key:"summary",fn:function(){return[a("div",{staticClass:"node-name"},[t._v(t._s(t.node.name)+" ("),a("span",[t._v(t._s(t.total)+" "+t._s(1==t.total?"field":"fields"))]),t._v(")")])]},proxy:!0}])},[a("section",{staticClass:"content"},t._l(t.node.data,(function(e){return a("SourceFieldNode",{key:e.name,ref:"childnode",refInFor:!0,attrs:{parents:t.parents.concat(t.node.name),node:e}})})),1)])]],2)},Z=[],tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail-container",class:{open:t.open}},[a("div",{staticClass:"summary",on:{click:t.onClick}},[t._t("summary")],2),a("transition",{attrs:{duration:{enter:t.animationEnterDuration,leave:t.animationLeaveDuration},"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"detail"},[t._t("default")],2)])],1)},et=[],at={name:"Details",data:function(){return{open:!1}},props:{animated:{type:Boolean,default:!1}},computed:{animationEnterDuration:function(){return this.animated?150:0},animationLeaveDuration:function(){return this.animated?300:0}},methods:{onClick:function(){this.open=!this.open}}},nt=at,st=(a("bd75"),Object(y["a"])(nt,tt,et,!1,null,"465a7bfa",null)),it=st.exports,rt={name:"SourceFieldNode",components:{Details:it},data:function(){return{open:!1}},props:{node:{type:Object,default:function(){}},parent_id:{type:String,default:""},parents:{type:Array,default:function(){return[]}}},computed:{total:function(){return Object(i["d"])(this.node)}},methods:{onClick:function(t){t.preventDefault(),this.open?this.collapse():this.expand()},expand:function(){this.open||(this.open=!0)},collapse:function(){this.open&&(this.open=!1)}}},ot=rt,ct=(a("49c6"),Object(y["a"])(ot,X,Z,!1,null,"2feef20c",null)),lt=ct.exports,dt={name:"FieldsReadOnly",components:{FieldNode:lt},props:{list:{type:Array,default:function(){return[]}}},computed:{sourceFields:function(){var t=this.$store.getters["nodes/getSelected"](this.list);if(t)return t.data}}},ut=dt,ft=(a("e56a"),a("599e"),Object(y["a"])(ut,Q,W,!1,null,"7b355296",null)),pt=ft.exports,mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",[a("span",[a("b",[t._v("Total MRNs:")]),t._v(" "+t._s(t.list.length))]),t.list.length<20?a("ul",t._l(t.list,(function(e,n){return a("li",{key:n},[t._v(t._s(e))])})),0):a("Details",{scopedSlots:t._u([{key:"summary",fn:function(){return[t._v("Show MRN list...")]},proxy:!0}])},[a("ul",t._l(t.list,(function(e,n){return a("li",{key:n},[t._v(t._s(e))])})),0)])],1)},vt=[],_t={name:"MRNList",components:{Details:it},props:{list:{type:Array,default:function(){return[]}}}},ht=_t,bt=(a("4c49"),Object(y["a"])(ht,mt,vt,!1,null,"11551bb5",null)),yt=bt.exports,xt={name:"RevisionDetail",components:{RevisionImportExport:j,RevisionMetadata:H,DateRangeInfo:G,FieldsReadOnly:pt,MRNList:yt},props:{revision:{type:Object,default:function(){return{}}}},computed:{creationDate:function(){return Object(i["b"])(this.revision.metadata.date,"MM-DD-YYYY hh:mm:ss")},readableCreationDate:function(){return Object(i["e"])(this.revision.metadata.date)},user:function(){return this.revision.metadata.creator},showMrns:function(){try{var t=this.revision.getTotaltMrns();return t>0}catch(e){return!1}}}},gt=xt,Ct=(a("1525"),Object(y["a"])(gt,n,s,!1,null,"3681d4ae",null));e["a"]=Ct.exports},"303e":function(t,e,a){},"35c1":function(t,e,a){},"479f":function(t,e,a){},"49c6":function(t,e,a){"use strict";var n=a("35c1"),s=a.n(n);s.a},"4c49":function(t,e,a){"use strict";var n=a("ad28"),s=a.n(n);s.a},5136:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.revision.isApproved()?a("i",{staticClass:"info status-approved far fa-check-circle",attrs:{title:"approved"}}):a("i",{staticClass:"info status-not-approved fas fa-ban",attrs:{title:"not approved"}}),t.revision.isExpired()?a("i",{staticClass:"info status-date-due far fa-calendar",attrs:{title:"date range is due"}}):a("i",{staticClass:"info status-date-valid far fa-calendar-check",attrs:{title:"date range is valid"}}),a("i",{staticClass:"info fas fa-hashtag",attrs:{title:"ID "+t.revision.getID()}})])},s=[],i={name:"RevisionMetadataIcons",props:{revision:{type:Object,default:null}}},r=i,o=(a("9dfa"),a("2877")),c=Object(o["a"])(r,n,s,!1,null,"42510773",null);e["a"]=c.exports},"599e":function(t,e,a){"use strict";var n=a("d018"),s=a.n(n);s.a},"734f":function(t,e,a){"use strict";var n=a("479f"),s=a.n(n);s.a},"80d1":function(t,e,a){},"8ae2":function(t,e,a){},9946:function(t,e,a){},"9d08":function(t,e,a){"use strict";var n=a("303e"),s=a.n(n);s.a},"9dfa":function(t,e,a){"use strict";var n=a("8ae2"),s=a.n(n);s.a},a28f:function(t,e,a){"use strict";var n=a("dfb8"),s=a.n(n);s.a},ad28:function(t,e,a){},bab3:function(t,e,a){},bc35:function(t,e,a){},bd75:function(t,e,a){"use strict";var n=a("bc35"),s=a.n(n);s.a},cd0b:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dropdown-container",class:{expanded:t.expanded},on:{mousedown:t.onMouseDown,click:t.onClick}},[a("button",{ref:"button",staticClass:"btn btn-secondary",class:{"btn-sm":t.small},attrs:{type:"button"},on:{blur:t.onBlur}},[t.icon?a("i",{class:t.icon}):t._e(),a("span",{domProps:{innerHTML:t._s(t.text)}}),t._v(" "),!t.hideCaret&&t.hasItems?a("i",{staticClass:"fas fa-caret-down status-indicator"}):t._e()]),a("section",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"menu",class:{right:t.right,bottom:t.bottom}},[t._t("items")],2)])},s=[],i={name:"Dropdown",data:function(){return{expanded:!1,showCaret:!1}},props:{icon:{type:String,default:""},hideCaret:{type:Boolean,default:!1},text:{type:String,default:"select"},small:{type:Boolean,default:!1},right:{type:Boolean,default:!1},bottom:{type:Boolean,default:!1}},computed:{hasItems:function(){return"undefined"!==typeof this.$slots.items&&this.$slots.items.length>0}},methods:{onMouseDown:function(t){t.preventDefault(),this.$refs.button.focus()},onBlur:function(t){this.collapse()},onClick:function(t){this.toggle()},toggle:function(){this.expanded?this.collapse():this.expand()},collapse:function(){this.expanded=!1,this.$refs.button.blur()},expand:function(){this.hasItems&&(this.expanded=!0)}}},r=i,o=(a("d86e"),a("2877")),c=Object(o["a"])(r,n,s,!1,null,"47813834",null);e["a"]=c.exports},d018:function(t,e,a){},d206:function(t,e,a){"use strict";var n=a("80d1"),s=a.n(n);s.a},d86e:function(t,e,a){"use strict";var n=a("9946"),s=a.n(n);s.a},dabe:function(t,e,a){"use strict";var n=a("bab3"),s=a.n(n);s.a},dfb8:function(t,e,a){},e56a:function(t,e,a){"use strict";var n=a("f622"),s=a.n(n);s.a},f1b9:function(t,e,a){},f622:function(t,e,a){}}]);
//# sourceMappingURL=datamart_vue.umd.min.0.js.map